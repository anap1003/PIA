<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui">

    <b:column col-sm="9" col-md="10" styleClass="main">
        <h:form id="contentForm">
            <p:steps activeIndex="#{festivals.step}">
                <p:menuitem value="Festival info"/>
                <p:menuitem value="Performances"/>
                <p:menuitem value="Media"/>
                <p:menuitem value="Overview"/>
            </p:steps>
            <b:panel title="Festival info" rendered="#{festivals.step == 0}">
                <div class="form-group col-md-5">
                    <label class="control-label">Name</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputText value="#{festivals.festival.name}" required="true" requiredMessage="Field 'Name' is mandatory."/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label">Location</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputText value="#{festivals.festival.location}" required="true" requiredMessage="Field 'Location' is mandatory."/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label">Start date</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group col-md-12">
                            <b:datepicker value="#{festivals.festival.dateStart}" required="true" requiredMessage="Field 'Start date' is mandatory."/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label">End date</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group col-md-12">
                            <b:datepicker value="#{festivals.festival.dateEnd}" required="true" requiredMessage="Field 'End date' is mandatory." />
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label">Max # of sold tickets/day</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputText value="#{festivals.festival.capacityPerDay}" required="true" requiredMessage="Field 'Tickets/day' is mandatory." maxlength="65535"/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label">Max # of sold tickets/user</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputText value="#{festivals.festival.maxTicketsPerUser}" required="true" requiredMessage="Field 'Tickets/user' is mandatory." maxlength="65535"/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Packet tickets price</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.packetPrice}" class="form-control" required="true" requiredMessage="Field 'Packet tickets price' is mandatory.">
                                <f:facet name="prepend">
                                    <b:icon name="user"/>
                                </f:facet>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Single tickets price</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.dayPrice}" class="form-control" required="true" requiredMessage="Field 'SIngle tickets price' is mandatory.">
                                <f:facet name="prepend">
                                    <b:icon name="user"/>
                                </f:facet>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-10">
                    <label class="control-label">Details</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputTextarea value="#{festivals.festival.details}" required="true" requiredMessage="Field 'Details' is mandatory." maxlength="65535"/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label">Facebook</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputText value="#{festivals.festival.facebook}" maxlength="65535"/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label">Twitter</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputText value="#{festivals.festival.twitter}" maxlength="65535"/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label">Instagram</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputText value="#{festivals.festival.instagram}" maxlength="65535"/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label">YouTube</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputText value="#{festivals.festival.youtube}" maxlength="65535"/>
                        </div>
                    </div>
                </div>
            </b:panel>
            <b:panel title="Performances" rendered="#{festivals.step == 1}">
                <div class="form-group col-md-10">
                    <label class="control-label" >Performer</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:inputText id="newPerformer" value="#{festivals.performance.artist}"/>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Start date</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:dateTimePicker id="a" value="#{festivals.performance.dateStart}" showTime="false" />
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >End date</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:dateTimePicker id="b" value="#{festivals.performance.dateEnd}" showTime="false" />
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Start time</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:dateTimePicker id="c" value="#{festivals.performance.timeStart}" showTime="true" showDate="false" />
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >End time</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <b:dateTimePicker id="d" value="#{festivals.performance.timeEnd}" showTime="true" showDate="false" />
                        </div>
                    </div>
                </div>
            </b:panel>
            <b:panel title="Media" rendered="#{festivals.step == 2}">
                <div class="form-group col-md-6">
                    <b:panel title="Pictures">
                        <h:panelGrid columns="1">
                            <p:outputLabel value="Add festival pictures" />
                            <p:galleria value="#{festivals.pictures}" panelWidth="400" panelHeight="300" var="picture" showCaption="false">
                                <p:graphicImage title="Festival pictures" value="#{galleryService.image}">
                                    <f:param name="filename" value="#{picture.path}" />
                                </p:graphicImage>
                            </p:galleria>
                            <p:fileUpload fileUploadListener="#{festivals.uploadImage}" mode="advanced" dragDropSupport="false" 
                                          multiple="true" update=":contentForm" sizeLimit="100000" fileLimit="5" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" />
                        </h:panelGrid>
                    </b:panel>
                </div>
                <div class="form-group col-md-6">
                    <b:panel title="Video">
                        <h:panelGrid columns="1">
                            <p:outputLabel value="Add festival video links in YouTube" />
                            <p:inputText value="#{festivals.videoUrl}" />
                            <p:commandButton value="Add video" action="#{festivals.uploadVideo}" update=":contentForm"/>
                        </h:panelGrid>
                    </b:panel>
                </div>
            </b:panel>
            <b:panel title="Overview" rendered="#{festivals.step==3}">
                <h3>Festival info</h3>
                <div class="form-group col-md-5">
                    <label class="control-label" >Name</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.name}" class="form-control" disabled="true">
                                <f:facet name="prepend">
                                    <b:icon name="user"/>
                                </f:facet>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Location</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.location}" class="form-control" disabled="true">
                                <f:facet name="prepend">
                                    <b:icon name="user"/>
                                </f:facet>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Start date</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.dateStart}" class="form-control" disabled="true">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >End date</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.dateEnd}" class="form-control" disabled="true">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Max # of tickets sold per day</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.capacityPerDay}" class="form-control" disabled="true">
                                <f:facet name="prepend">
                                    <b:icon name="user"/>
                                </f:facet>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Max # of tickets sold per user</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.maxTicketsPerUser}" class="form-control" disabled="true">
                                <f:facet name="prepend">
                                    <b:icon name="user"/>
                                </f:facet>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Packet tickets price</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.packetPrice}" class="form-control" disabled="true">
                                <f:facet name="prepend">
                                    <b:icon name="user"/>
                                </f:facet>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="form-group col-md-5">
                    <label class="control-label" >Single tickets price</label> 
                    <div class="inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <p:inputText value="#{festivals.festival.dayPrice}" class="form-control" disabled="true">
                                <f:facet name="prepend">
                                    <b:icon name="user"/>
                                </f:facet>
                            </p:inputText>
                        </div>
                    </div>
                </div>

                <div class="col-md-10">
                    <h4>Performances info</h4>
                </div>

                <div class="form-group col-md-10">
                    <b:dataTable value="#{festivals.performances}" var="performance" searching="false">
                        <h:column>
                            <f:facet name="header">Artist</f:facet>
                            <h:outputText value="#{performance.artist}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">Start date</f:facet>
                            <h:outputText value="#{performance.dateStart}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </h:column>
                        <h:column>
                            <f:facet name="header">End date</f:facet>
                            <h:outputText value="#{performance.dateEnd}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputText>
                        </h:column>
                        <h:column>
                            <f:facet name="header">Start time</f:facet>
                            <h:outputText value="#{performance.timeStart}">
                                <f:convertDateTime pattern="hh:mm:ss aaa"/>
                            </h:outputText>
                        </h:column>
                        <h:column>
                            <f:facet name="header">End time</f:facet>
                            <h:outputText value="#{performance.timeEnd}">
                                <f:convertDateTime pattern="hh:mm:ss aaa"/>
                            </h:outputText>
                        </h:column>
                    </b:dataTable>
                </div>

                <div class="col-md-5">
                    <p:galleria value="#{festivals.pictures}" panelWidth="400" panelHeight="300" var="picture" showCaption="false">
                        <p:graphicImage title="Festival pictures" value="#{galleryService.image}">
                            <f:param name="filename" value="#{picture.path}" />
                        </p:graphicImage>
                    </p:galleria>
                </div>

                <div class="col-md-5">
                    <h:panelGrid columns="1">
                        <p:repeat value="#{festivals.video}" var="v" offset="0" size="1" step="1" varStatus="#{null}">
                            <p:media value="#{v.path}" player="flash">
                                <f:param name="autoPlay" value="0"/>
                            </p:media>
                        </p:repeat>
                    </h:panelGrid>
                </div>
            </b:panel>
            <p align="right">
                <p:commandButton value="Dodaj nastup" action="#{festivals.addPerformance()}" process="a, b, c, d, newPerformer" update=":contentForm" rendered="#{festivals.step==1}" disabled="#{festivals.step!=1}"/>
                <p:commandButton value="Next" action="#{festivals.saveInfoAndContinue()}" update=":contentForm" rendered="#{festivals.step!=3}"/>
                <p:commandButton value="Save" action="#{festivals.saveFestival}" update=":contentForm" disabled="#{festivals.step!=3}" rendered="#{festivals.step==3}"/>
                <p:commandButton value="Discard" action="#{festivals.discardFestival}" update=":contentForm" disabled="#{festivals.step!=3}" rendered="#{festivals.step==3}"/>
            </p>
        </h:form>
    </b:column>
    <b:column col-sm="3" col-md="2">
        <p:messages/>
    </b:column>
</ui:composition>